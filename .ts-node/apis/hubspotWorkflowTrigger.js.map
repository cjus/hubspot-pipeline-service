{"version":3,"file":"hubspotWorkflowTrigger.js","sourceRoot":"","sources":["../../app/apis/hubspotWorkflowTrigger.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,gDAAuC;AACvC,gDAAoD;AAcvC,QAAA,yBAAyB,GAAG,IAAI,0BAAc,CAAmD,0BAA0B,EAAE,UAAC,MAAM,EAAE,KAAK;IACpJ,IAAM,WAAW;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;sGAAqE,CAAC;IACvF,IAAM,YAAY,GAAG,IAAI,eAAe,CAAC,MAAa,CAAC,CAAC;IACxD,IAAM,eAAe,GAAG,WAAW,CAAC,YAAY,CAAC,CAAC;IAClD,OAAO,CAAC,yEAAO,EAAmD,EAAE,EAAU;;YAA7D,oBAAgC,EAAhC,YAAY,mBAAG,iBAAiB,KAAA,EAAE,aAAa,EAAb,KAAK,mBAAG,KAAK,KAAA;YAAM,MAAM,YAAA;;YAClE,SAAS,GAAG,IAAI,IAAI,EAAE,CAAC,WAAW,EAAE,CAAC;YACrC,WAAW,GAAG,UAAG,YAAY,cAAI,IAAI,CAAC,GAAG,EAAE,cAAI,IAAI,CAAC,MAAM,EAAE,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,CAAE,CAAC;YAC/F,IAAI,CAAC;gBACD,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,aAAa,EAAE,CAAC;oBAC7B,MAAM,IAAI,KAAK,CAAC,uEAAuE,CAAC,CAAC;gBAC7F,CAAC;gBACD,IAAI,YAAY,KAAK,iBAAiB,EAAE,CAAC;oBACrC,MAAM,IAAI,KAAK,CAAC,4BAAqB,YAAY,2CAAwC,CAAC,CAAC;gBAC/F,CAAC;gBACD,KAAK,MAAM,CAAC,QAAQ,CAAC,OAAO,CAAC,YAAY,EAAE,EAAE,CAAC,CAAC;gBAC/C,sBAAO;wBACH,OAAO,EAAE,IAAI;wBACb,YAAY,cAAA;wBACZ,WAAW,aAAA;wBACX,MAAM,EAAE,SAAS;wBACjB,OAAO,EAAE,mBAAY,YAAY,4BAAyB;wBAC1D,SAAS,WAAA;qBACZ,EAAC;YACN,CAAC;YACD,OAAO,KAAK,EAAE,CAAC;gBACL,OAAO,GAAG,KAAK,YAAY,KAAK,CAAC,CAAC,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC,CAAC,eAAe,CAAC;gBACzE,sBAAO;wBACH,OAAO,EAAE,KAAK;wBACd,YAAY,cAAA;wBACZ,WAAW,aAAA;wBACX,MAAM,EAAE,QAAQ;wBAChB,OAAO,EAAE,sCAA+B,OAAO,CAAE;wBACjD,SAAS,WAAA;wBACT,KAAK,EAAE,OAAO;qBACjB,EAAC;YACN,CAAC;;;SACJ,CAAC,CAAC,eAAe,EAAE,KAAK,CAAC,CAAC;AAC/B,CAAC,EAAE,EAAE;;;;;;;;;;;;;;;;;;;;;;;GAEC,IAAI,CAAC,KAAK,CAAC,mSAAmS,CAAQ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;EAEvT,CAAC","sourcesContent":["import ____moose____typia from \"typia\";\nimport { ConsumptionApi } from \"@514labs/moose-lib\";\ninterface WorkflowTriggerParams {\n    workflowName?: string;\n    force?: boolean;\n}\ninterface WorkflowExecutionResponse {\n    success: boolean;\n    workflowName: string;\n    executionId: string;\n    status: \"started\" | \"failed\";\n    message: string;\n    startTime: string;\n    error?: string;\n}\nexport const HubSpotWorkflowTriggerApi = new ConsumptionApi<WorkflowTriggerParams, WorkflowExecutionResponse>(\"hubspot-workflow-trigger\", (params, utils) => {\n    const assertGuard = ____moose____typia.http.createAssertQuery<WorkflowTriggerParams>();\n    const searchParams = new URLSearchParams(params as any);\n    const processedParams = assertGuard(searchParams);\n    return (async ({ workflowName = \"hubspotDataSync\", force = false }, { client }) => {\n        const startTime = new Date().toISOString();\n        const executionId = `${workflowName}-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;\n        try {\n            if (!process.env.HUBSPOT_TOKEN) {\n                throw new Error(\"HUBSPOT_TOKEN environment variable is required for workflow execution\");\n            }\n            if (workflowName !== \"hubspotDataSync\") {\n                throw new Error(`Unknown workflow: ${workflowName}. Available workflows: hubspotDataSync`);\n            }\n            void client.workflow.execute(workflowName, {});\n            return {\n                success: true,\n                workflowName,\n                executionId,\n                status: \"started\",\n                message: `Workflow ${workflowName} triggered successfully`,\n                startTime,\n            };\n        }\n        catch (error) {\n            const message = error instanceof Error ? error.message : \"Unknown error\";\n            return {\n                success: false,\n                workflowName,\n                executionId,\n                status: \"failed\",\n                message: `Failed to trigger workflow: ${message}`,\n                startTime,\n                error: message,\n            };\n        }\n    })(processedParams, utils);\n}, {}, ____moose____typia.json.schemas<[\n    WorkflowTriggerParams\n]>(), JSON.parse(\"[{\\\"name\\\":\\\"workflowName\\\",\\\"data_type\\\":\\\"String\\\",\\\"primary_key\\\":false,\\\"required\\\":false,\\\"unique\\\":false,\\\"default\\\":null,\\\"annotations\\\":[]},{\\\"name\\\":\\\"force\\\",\\\"data_type\\\":\\\"Boolean\\\",\\\"primary_key\\\":false,\\\"required\\\":false,\\\"unique\\\":false,\\\"default\\\":null,\\\"annotations\\\":[]}]\") as any, ____moose____typia.json.schemas<[\n    WorkflowExecutionResponse\n]>());\n"]}